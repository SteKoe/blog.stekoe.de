---
title: "Spotlight: Git objects"
tags:
- git
- objects
---
Have you ever wondered how Git handles files and folders in the magical `.git` folder?
Well, I did and hence I started to investigate further.
In this article I will present the results and explain the way how Git objects are interconnected.

Git is a source code management (SCM) system invented back in 2005 by Linus Torvalds, founder and inventor of Linux Kernel.
His intention was to implement a distributed SCM system which suppots common development workflows more easily than compared to other SCMs like SVN.
This includes that commits can be made locally without having the need of a remote repository or remote server.
Compared to SVN which uses incemented revision numbers, Git has to rely on some other technique since there may occur revision collisions when merging local and remote changes, otherwise.
Hence Git introduces hashes using SHA1 for each and every resource which is tracked.
The reason for using SHA1 is simple, as it is a fast but relyable algorithm to calculate hashes for a given input.
Although it is not very secure &mdash; it should not be used for hashing passwords anymore due to collision attacks &mdash; it is sufficient for the purpose of Git.

## How Git handle contents
Git relies on the filesystem of the underlying operating system.
A filesystem basically has two different concepts: Files and folders.
Although Git does not track folders but files, there are two corresponding abstractions in Git's source code: Tree and Blob.
A Blob contains the value of a file whereas a Tree is the pendant to a folder by listing all contained Blobs.

### Dude! Give me an example! Please!
Yes, this is all very abstract, to be honest.
So let us have a look at an example.

#### Files / Blobs
We assume that we have a file called `test.jsx`.
This file contains a simple, but well-known string: `Hello, World!`.
I wrote, that Git tracks files by its contents using a SHA1 hash.
When hashing the string above one will get `60fde9c2310b0d4cad4dab8d126b04387efba289` as hash value.

Let's verify this by creating a new Git repository, add the file and inspect the `.git/objects/` folder:

```bash
$ git init.
$ echo -n Hello, World! > test.jsx
$ git add .
```
The `.git/objects` folder now contains one folders including one file:

```
.git
 `-- objects
     +-- b4
     |   `-- 5ef6fec89518d314f546fd6c3025367b721684
     +-- info
     `-- pack
```
The file and folder names are obviously hashed values of something.
In order to investigate the contents of a file, one can use the command `git cat-file -p b45e` which prints out:

```bash
$ git cat-file -p b45e
Hello, World!
```
Wait, what?! Why does the file has a hash value of `b4/5ef6fec89518d314f546fd6c3025367b721684`?
We did calculate some different hash value which is `60fde9c2310b0d4cad4dab8d126b04387efba289`, didn't we?
Well, yes, we did, but Git tracks a little bit more information than just the plain content of a file:
It also respects the file size as well as the type of Git object that is tracked.
In this case the file has a size of 13 byte and is of type Blob.
These information and the content of the file are taken, put into a new object and then hashed:

```
blob 13\0Hello, World!
```
The format for Blobs is specified as follows: `blob<blank><filesize in byte><null byte><file content>`.
The null byte is used to separate the content of a file from the git specific header which contains meta data.
If we hash the resulting string above once more, SHA1 returns `b45ef6fec89518d314f546fd6c3025367b721684`.
Looks familiar, right? Yes, it is the very same hash as generated by Git.

We are done, aren't we? But wait... What about folders?
Until now Git has tracked files and its content, so we will have a look at folders now.

#### Folders
Since we are very happy having a mature test.txt file now, let's first commit that and than investiagte further.

```bash
git commit -m "Initial commit."
```


```bash
$ git cat-file -p 1037
100644 blob 8dff688d90e02081f71f4390ad659100a35d6551	hello-world.jsx
100644 blob 639f53d8e3fadff02292f823c3f3406491549e02	another-file.jsx
```

## Appendix: Git hash calculations reconstructed in JavaScript
{% gist SteKoe/20462841fa2b47ef6bcc %}